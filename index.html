<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BALL x PIT ËøõÂåñÂõæÈâ¥</title>
  <meta name="description" content="Ball x Pit ÂÆåÊï¥ËøõÂåñÂõæÈâ¥ - Áü©Èòµ/ÂàóË°®/ÂõæÈâ¥‰∏âÁßçËßÜÂõæ">
  
  <style>
    /* ========== CSS ÂèòÈáè ========== */
    :root {
      --bg-primary: #0a0e14;
      --bg-secondary: #141b22;
      --bg-tertiary: #1a2332;
      --bg-hover: #243044;
      --border-color: #2a3a4a;
      --text-primary: #e6edf3;
      --text-secondary: #8b949e;
      --text-muted: #6e7681;
      --accent-primary: #58a6ff;
      --accent-secondary: #3fb950;
      --accent-warning: #d29922;
      --accent-danger: #f85149;
      --accent-purple: #a371f7;
      --accent-pink: #db61a2;
      --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.4);
      --radius-sm: 6px;
      --radius-md: 10px;
      --radius-lg: 16px;
      --transition-fast: 0.15s ease;
      --transition-normal: 0.25s ease;
    }

    /* ========== Âü∫Á°ÄÊ†∑Âºè ========== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      line-height: 1.5;
    }

    /* ========== Â§¥ÈÉ® ========== */
    .header {
      background: linear-gradient(180deg, var(--bg-secondary) 0%, var(--bg-primary) 100%);
      padding: 24px 20px;
      text-align: center;
      border-bottom: 1px solid var(--border-color);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .header h1 {
      font-size: 28px;
      font-weight: 700;
      background: linear-gradient(135deg, var(--accent-primary), var(--accent-purple));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 8px;
      letter-spacing: 2px;
    }

    .header p {
      color: var(--text-secondary);
      font-size: 14px;
    }

    /* ========== ÊéßÂà∂Ê†è ========== */
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      justify-content: center;
      align-items: center;
      padding: 16px 20px;
      background: var(--bg-secondary);
      border-bottom: 1px solid var(--border-color);
    }

    .search-box {
      position: relative;
      flex: 1;
      max-width: 320px;
      min-width: 200px;
    }

    .search-box input {
      width: 100%;
      padding: 10px 16px 10px 40px;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      color: var(--text-primary);
      font-size: 14px;
      transition: var(--transition-fast);
    }

    .search-box input:focus {
      outline: none;
      border-color: var(--accent-primary);
      box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.15);
    }

    .search-box::before {
      content: "üîç";
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 14px;
      opacity: 0.6;
    }

    .view-tabs {
      display: flex;
      background: var(--bg-tertiary);
      border-radius: var(--radius-md);
      padding: 4px;
      gap: 4px;
    }

    .view-tab {
      padding: 8px 16px;
      background: transparent;
      border: none;
      border-radius: var(--radius-sm);
      color: var(--text-secondary);
      font-size: 14px;
      cursor: pointer;
      transition: var(--transition-fast);
      font-weight: 500;
    }

    .view-tab:hover {
      color: var(--text-primary);
      background: var(--bg-hover);
    }

    .view-tab.active {
      background: var(--accent-primary);
      color: white;
    }

    /* ========== ‰∏ªÂÜÖÂÆπÂå∫ ========== */
    .main-content {
      padding: 20px;
      max-width: 1600px;
      margin: 0 auto;
    }

    .view-container {
      display: none;
    }

    .view-container.active {
      display: block;
    }

    /* ========== Áü©ÈòµËßÜÂõæ ========== */
    .matrix-wrapper {
      overflow-x: auto;
      padding-bottom: 20px;
    }

    .matrix-table {
      border-collapse: collapse;
      margin: 0 auto;
      border: 2px solid #4a5a6a;
    }

    .matrix-table th,
    .matrix-table td {
      width: 60px;
      height: 60px;
      text-align: center;
      vertical-align: middle;
      font-size: 10px;
      position: relative;
      border: 1px solid #2a3a4a;
    }

    .matrix-table th {
      background: var(--bg-tertiary);
      color: var(--text-secondary);
      font-weight: 600;
      padding: 4px;
      border: 1px solid #3a4a5a;
    }

    /* Á¨¨‰∏ÄË°åÂíåÁ¨¨‰∏ÄÂàóÁöÑË°®Â§¥Âä†Á≤óËæπÊ°Ü */
    .matrix-table tr:first-child th {
      border-bottom: 2px solid #5a6a7a;
    }

    .matrix-table th:first-child {
      border-right: 2px solid #5a6a7a;
    }

    /* ÊØè5Ë°å/ÂàóÊ∑ªÂä†ÂàÜÈöîÁ∫ø‰æø‰∫éÈòÖËØª */
    .matrix-table tr:nth-child(6) td,
    .matrix-table tr:nth-child(6) th,
    .matrix-table tr:nth-child(11) td,
    .matrix-table tr:nth-child(11) th,
    .matrix-table tr:nth-child(16) td,
    .matrix-table tr:nth-child(16) th {
      border-top: 2px solid #3d4d5d;
    }

    .matrix-table td:nth-child(6),
    .matrix-table th:nth-child(6),
    .matrix-table td:nth-child(11),
    .matrix-table th:nth-child(11),
    .matrix-table td:nth-child(16),
    .matrix-table th:nth-child(16) {
      border-left: 2px solid #3d4d5d;
    }

    .matrix-table th img {
      width: 32px;
      height: 32px;
      object-fit: contain;
      display: block;
      margin: 0 auto 2px;
      border-radius: 4px;
    }

    .matrix-table th span {
      display: block;
      font-size: 8px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .matrix-cell {
      background: var(--bg-secondary);
      cursor: pointer;
      transition: var(--transition-fast);
      padding: 4px;
    }

    .matrix-cell:hover {
      background: var(--bg-hover);
      box-shadow: inset 0 0 0 2px var(--accent-primary);
      z-index: 10;
    }

    .matrix-cell.empty {
      background: var(--bg-primary);
      cursor: default;
    }

    .matrix-cell.empty:hover {
      box-shadow: none;
    }

    .matrix-cell img {
      width: 36px;
      height: 36px;
      object-fit: contain;
      display: block;
      margin: 0 auto;
      border-radius: 4px;
    }

    .matrix-cell .cell-name {
      font-size: 8px;
      color: var(--text-secondary);
      margin-top: 2px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .matrix-cell.highlight {
      box-shadow: 0 0 0 2px var(--accent-primary);
    }

    /* ========== ÂàóË°®ËßÜÂõæ ========== */
    .list-view {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 16px;
    }

    .list-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      overflow: hidden;
      transition: var(--transition-normal);
    }

    .list-card:hover {
      border-color: var(--accent-primary);
      transform: translateY(-2px);
      box-shadow: var(--shadow-lg);
    }

    .list-card-header {
      background: var(--bg-tertiary);
      padding: 12px 16px;
      display: flex;
      align-items: center;
      gap: 12px;
      border-bottom: 1px solid var(--border-color);
    }

    .list-card-header img {
      width: 40px;
      height: 40px;
      object-fit: contain;
      border-radius: 6px;
    }

    .list-card-header h3 {
      font-size: 15px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .list-card-header .subtitle {
      font-size: 12px;
      color: var(--text-secondary);
    }

    .list-card-body {
      padding: 12px 16px;
    }

    .combo-item {
      display: flex;
      align-items: center;
      padding: 8px 0;
      border-bottom: 1px solid var(--border-color);
      cursor: pointer;
      transition: var(--transition-fast);
    }

    .combo-item:last-child {
      border-bottom: none;
    }

    .combo-item:hover {
      background: var(--bg-hover);
      margin: 0 -16px;
      padding: 8px 16px;
    }

    .combo-item img {
      width: 28px;
      height: 28px;
      object-fit: contain;
      margin-right: 10px;
      border-radius: 4px;
    }

    .combo-item .combo-text {
      flex: 1;
      font-size: 13px;
    }

    .combo-item .partner {
      color: var(--text-secondary);
    }

    .combo-item .arrow {
      color: var(--accent-primary);
      margin: 0 8px;
    }

    .combo-item .result {
      color: var(--accent-secondary);
      font-weight: 500;
    }

    /* ========== ÂõæÈâ¥ËßÜÂõæ ========== */
    .gallery-section {
      margin-bottom: 32px;
    }

    .gallery-section:last-child {
      margin-bottom: 0;
    }

    .gallery-section-title {
      font-size: 16px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 16px;
      padding-bottom: 8px;
      border-bottom: 2px solid var(--accent-primary);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .gallery-section-title::before {
      content: "";
      width: 4px;
      height: 18px;
      background: var(--accent-primary);
      border-radius: 2px;
    }

    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 12px;
    }

    .gallery-item {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      padding: 16px;
      text-align: center;
      cursor: pointer;
      transition: var(--transition-normal);
    }

    .gallery-item:hover {
      border-color: var(--accent-primary);
      transform: translateY(-4px);
      box-shadow: var(--shadow-lg);
    }

    .gallery-item img {
      width: 64px;
      height: 64px;
      object-fit: contain;
      margin-bottom: 8px;
      border-radius: 8px;
    }

    .gallery-item .item-name {
      font-size: 13px;
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .gallery-item .item-name-cn {
      font-size: 11px;
      color: var(--text-secondary);
    }

    .gallery-item .item-tier {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 10px;
      font-size: 10px;
      margin-top: 6px;
    }

    .tier-basic {
      background: rgba(88, 166, 255, 0.2);
      color: var(--accent-primary);
    }

    .tier-evolved {
      background: rgba(63, 185, 80, 0.2);
      color: var(--accent-secondary);
    }

    .tier-advanced {
      background: rgba(163, 113, 247, 0.2);
      color: var(--accent-purple);
    }

    .tier-passive {
      background: rgba(210, 153, 34, 0.2);
      color: var(--accent-warning);
    }

    /* ========== ÂºπÁ™ó ========== */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      padding: 20px;
    }

    .modal-overlay.active {
      display: flex;
    }

    .modal {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-lg);
      max-width: 480px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      animation: modalIn 0.25s ease;
    }

    @keyframes modalIn {
      from {
        opacity: 0;
        transform: scale(0.9) translateY(20px);
      }
      to {
        opacity: 1;
        transform: scale(1) translateY(0);
      }
    }

    .modal-header {
      display: flex;
      align-items: center;
      gap: 16px;
      padding: 20px;
      background: var(--bg-tertiary);
      border-bottom: 1px solid var(--border-color);
    }

    .modal-header img {
      width: 72px;
      height: 72px;
      object-fit: contain;
      border-radius: var(--radius-md);
      background: var(--bg-secondary);
      padding: 8px;
    }

    .modal-header-info h2 {
      font-size: 20px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .modal-header-info .cn-name {
      font-size: 14px;
      color: var(--text-secondary);
    }

    .modal-close {
      position: absolute;
      top: 16px;
      right: 16px;
      width: 32px;
      height: 32px;
      background: var(--bg-hover);
      border: none;
      border-radius: 50%;
      color: var(--text-secondary);
      font-size: 18px;
      cursor: pointer;
      transition: var(--transition-fast);
    }

    .modal-close:hover {
      background: var(--accent-danger);
      color: white;
    }

    .modal-body {
      padding: 20px;
    }

    .modal-section {
      margin-bottom: 20px;
    }

    .modal-section:last-child {
      margin-bottom: 0;
    }

    .modal-section h4 {
      font-size: 12px;
      font-weight: 600;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 10px;
    }

    .combo-formula {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      background: var(--bg-tertiary);
      border-radius: var(--radius-md);
      flex-wrap: wrap;
    }

    .combo-ball {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      cursor: pointer;
      padding: 8px;
      border-radius: var(--radius-sm);
      transition: var(--transition-fast);
    }

    .combo-ball:hover {
      background: var(--bg-hover);
    }

    .combo-ball img {
      width: 48px;
      height: 48px;
      object-fit: contain;
      border-radius: 6px;
    }

    .combo-ball span {
      font-size: 11px;
      color: var(--text-secondary);
      text-align: center;
    }

    .combo-plus {
      font-size: 24px;
      color: var(--text-muted);
      font-weight: 300;
    }

    .combo-equals {
      font-size: 24px;
      color: var(--accent-primary);
    }

    .effect-text {
      font-size: 14px;
      color: var(--text-primary);
      line-height: 1.7;
      padding: 12px;
      background: var(--bg-tertiary);
      border-radius: var(--radius-md);
      border-left: 3px solid var(--accent-primary);
    }

    /* ========== È´òÁ∫ß/Ë¢´Âä®ËøõÂåñÂå∫ ========== */
    .advanced-section {
      margin-top: 32px;
      padding-top: 24px;
      border-top: 1px solid var(--border-color);
    }

    .section-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .section-title::before {
      content: "";
      width: 4px;
      height: 20px;
      background: var(--accent-purple);
      border-radius: 2px;
    }

    .advanced-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 12px;
    }

    .advanced-card {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: var(--transition-fast);
    }

    .advanced-card:hover {
      border-color: var(--accent-purple);
      background: var(--bg-tertiary);
    }

    .advanced-card img {
      width: 48px;
      height: 48px;
      object-fit: contain;
      border-radius: 6px;
    }

    .advanced-card-info {
      flex: 1;
    }

    .advanced-card-info h4 {
      font-size: 14px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .advanced-card-info p {
      font-size: 12px;
      color: var(--text-secondary);
    }

    /* ========== Á©∫Áä∂ÊÄÅ ========== */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: var(--text-muted);
    }

    .empty-state-icon {
      font-size: 48px;
      margin-bottom: 16px;
      opacity: 0.5;
    }

    /* ========== ÂìçÂ∫îÂºè ========== */
    @media (max-width: 768px) {
      .header h1 {
        font-size: 22px;
      }

      .controls {
        padding: 12px;
      }

      .search-box {
        min-width: 100%;
      }

      .main-content {
        padding: 12px;
      }

      .matrix-table th,
      .matrix-table td {
        width: 50px;
        height: 50px;
      }

      .matrix-table th img {
        width: 24px;
        height: 24px;
      }

      .matrix-cell img {
        width: 28px;
        height: 28px;
      }

      .gallery-grid {
        grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
      }

      .gallery-item img {
        width: 48px;
        height: 48px;
      }
    }

    /* ========== ÊªöÂä®Êù° ========== */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: var(--bg-primary);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border-color);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--text-muted);
    }

    /* ========== ÊÇ¨ÊµÆÊèêÁ§∫Ê°Ü ========== */
    .tooltip {
      position: fixed;
      z-index: 2000;
      background: var(--bg-secondary);
      border: 1px solid var(--accent-primary);
      border-radius: var(--radius-md);
      padding: 12px;
      max-width: 320px;
      min-width: 240px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
      pointer-events: none;
      opacity: 0;
      transform: translateY(8px);
      transition: opacity 0.15s ease, transform 0.15s ease;
    }

    .tooltip.visible {
      opacity: 1;
      transform: translateY(0);
    }

    .tooltip-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--border-color);
    }

    .tooltip-header img {
      width: 48px;
      height: 48px;
      object-fit: contain;
      border-radius: 6px;
      background: var(--bg-tertiary);
      padding: 4px;
    }

    .tooltip-title {
      font-size: 15px;
      font-weight: 600;
      color: var(--text-primary);
    }

    .tooltip-title-cn {
      font-size: 12px;
      color: var(--text-secondary);
    }

    .tooltip-formula {
      display: flex;
      align-items: center;
      gap: 6px;
      flex-wrap: wrap;
      margin-bottom: 10px;
      padding: 8px;
      background: var(--bg-tertiary);
      border-radius: 6px;
      font-size: 12px;
      color: var(--text-secondary);
    }

    .tooltip-formula img {
      width: 24px;
      height: 24px;
      object-fit: contain;
      border-radius: 4px;
    }

    .tooltip-formula .plus {
      color: var(--text-muted);
    }

    .tooltip-formula .equals {
      color: var(--accent-primary);
      font-weight: bold;
    }

    .tooltip-effect {
      font-size: 12px;
      color: var(--text-primary);
      line-height: 1.5;
      padding: 8px;
      background: var(--bg-tertiary);
      border-radius: 6px;
      border-left: 2px solid var(--accent-primary);
    }

    /* ========== ÈöêËóèÁ±ª ========== */
    .hidden {
      display: none !important;
    }

    /* ========== Âä†ËΩΩÊèêÁ§∫ ========== */
    .loading {
      text-align: center;
      padding: 40px;
      color: var(--text-secondary);
    }

    .loading::after {
      content: "";
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 2px solid var(--border-color);
      border-top-color: var(--accent-primary);
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin-left: 10px;
      vertical-align: middle;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }
  </style>
</head>
<body>

  <!-- Â§¥ÈÉ® -->
  <header class="header">
    <h1>BALL x PIT ËøõÂåñÂõæÈâ¥</h1>
    <p>ÂÆåÊï¥ËøõÂåñÁªÑÂêàÂèÇËÄÉ | Complete Evolution Guide</p>
  </header>

  <!-- ÊéßÂà∂Ê†è -->
  <div class="controls">
    <div class="search-box">
      <input 
        type="text" 
        id="searchInput" 
        placeholder="ÊêúÁ¥¢ÁêÉÂêç... / Search balls..."
        autocomplete="off"
      >
    </div>
    
    <div class="view-tabs">
      <button class="view-tab active" data-view="matrix">Áü©Èòµ</button>
      <button class="view-tab" data-view="list">ÂàóË°®</button>
      <button class="view-tab" data-view="gallery">ÂõæÈâ¥</button>
    </div>

  </div>

  <!-- ‰∏ªÂÜÖÂÆπ -->
  <main class="main-content">
    
    <!-- Áü©ÈòµËßÜÂõæ -->
    <div id="matrixView" class="view-container active">
      <div class="matrix-wrapper">
        <table class="matrix-table" id="matrixTable">
          <tbody></tbody>
        </table>
      </div>
    </div>

    <!-- ÂàóË°®ËßÜÂõæ -->
    <div id="listView" class="view-container">
      <div class="list-view" id="listContainer"></div>
    </div>

    <!-- ÂõæÈâ¥ËßÜÂõæ -->
    <div id="galleryView" class="view-container">
      <div class="gallery-section">
        <h3 class="gallery-section-title">Âü∫Á°ÄÁêÉ Basic Balls</h3>
        <div class="gallery-grid" id="galleryBasic"></div>
      </div>
      <div class="gallery-section">
        <h3 class="gallery-section-title">ËøõÂåñÁêÉ Evolved Balls</h3>
        <div class="gallery-grid" id="galleryEvolved"></div>
      </div>
      <div class="gallery-section">
        <h3 class="gallery-section-title">È´òÁ∫ßËøõÂåñ Advanced Evolutions</h3>
        <div class="gallery-grid" id="galleryAdvanced"></div>
      </div>
      <div class="gallery-section">
        <h3 class="gallery-section-title">Ë¢´Âä®ÈÅìÂÖ∑ Passive Items</h3>
        <div class="gallery-grid" id="galleryPassive"></div>
      </div>
    </div>

    <!-- È´òÁ∫ßËøõÂåñÂå∫ -->
    <section class="advanced-section" id="advancedSection">
      <h3 class="section-title">È´òÁ∫ßÂºπÁè†ËøõÂåñ</h3>
      <div class="advanced-grid" id="advancedGrid"></div>
    </section>

    <!-- Ë¢´Âä®ÈÅìÂÖ∑ËøõÂåñÂå∫ -->
    <section class="advanced-section" id="passiveSection">
      <h3 class="section-title">Ë¢´Âä®ÈÅìÂÖ∑ËøõÂåñ</h3>
      <div class="advanced-grid" id="passiveGrid"></div>
    </section>

  </main>

  <!-- ÊÇ¨ÊµÆÊèêÁ§∫Ê°Ü -->
  <div class="tooltip" id="tooltip">
    <div class="tooltip-header">
      <img id="tooltipImg" src="" alt="">
      <div class="tooltip-title-wrap">
        <div class="tooltip-title" id="tooltipTitle"></div>
        <div class="tooltip-title-cn" id="tooltipTitleCn"></div>
      </div>
    </div>
    <div class="tooltip-effect" id="tooltipEffect"></div>
    <div class="tooltip-formula" id="tooltipFormula"></div>
  </div>

  <!-- ËØ¶ÊÉÖÂºπÁ™ó -->
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal">
      <button class="modal-close" id="modalClose">&times;</button>
      <div class="modal-header">
        <img id="modalImg" src="" alt="">
        <div class="modal-header-info">
          <h2 id="modalTitle"></h2>
          <div class="cn-name" id="modalTitleCn"></div>
        </div>
      </div>
      <div class="modal-body">
        <div class="modal-section">
          <h4>ÂêàÊàêÈÖçÊñπ / Recipe</h4>
          <div class="combo-formula" id="modalFormula"></div>
        </div>
        <div class="modal-section">
          <h4>ÊïàÊûúÊèèËø∞ / Effect</h4>
          <div class="effect-text" id="modalEffect"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ========== Êï∞ÊçÆÂÆö‰πâ ==========
    const BASE_BALLS = [
      { id: "BLEED", name: "Bleed", nameCn: "ÊµÅË°Ä", img: "ball_icon_bleed.png", effectCn: "ÊîªÂáª‰ºö‰ΩøÊïå‰∫∫ÊµÅË°ÄÔºåÂú®‰∏ÄÊÆµÊó∂Èó¥ÂÜÖÈÄ†ÊàêÊåÅÁª≠‰º§ÂÆ≥„ÄÇ" },
      { id: "BROOD_MOTHER", name: "Brood Mother", nameCn: "ËÇ≤ÊØç", img: "ball_icon_brood_mother.png", effectCn: "Âë®ÊúüÊÄßÂú∞‰∫ßÁîüÂ∞èÂûãÂçï‰Ωç‰∏∫‰Ω†‰ΩúÊàò„ÄÇ" },
      { id: "BURN", name: "Burn", nameCn: "ÁáÉÁÉß", img: "ball_icon_burn.png", effectCn: "ÊîªÂáª‰ºöÁÇπÁáÉÊïå‰∫∫ÔºåÈÄ†ÊàêÊåÅÁª≠ÁöÑÁÅ´ÁÑ∞‰º§ÂÆ≥„ÄÇ" },
      { id: "CELL", name: "Cell", nameCn: "ÁªÜËÉû", img: "ball_icon_cell.png", effectCn: "ÂÖ∑ÊúâÂàÜË£ÇÂíåÂ¢ûÊÆñËÉΩÂäõÁöÑÂºπÁè†„ÄÇ" },
      { id: "CHARM", name: "Charm", nameCn: "È≠ÖÊÉë", img: "ball_icon_love_charm.png", effectCn: "ÊîªÂáª‰ºöËø∑ÊÉëÊïå‰∫∫Ôºå‰ΩøÂÖ∂ÊöÇÊó∂ÂÅúÊ≠¢ÊîªÂáªÊàñÊîªÂáªÂÖ∂ÂèãÂÜõ„ÄÇ" },
      { id: "DARK", name: "Dark", nameCn: "ÈªëÊöó", img: "ball_icon_dark.png", effectCn: "ËøêÁî®ÊöóÂΩ±ËÉΩÈáèÔºåÈÄöÂ∏∏ÈôÑÂ∏¶ËØÖÂííÊàñÂâäÂº±ÊïàÊûú„ÄÇ" },
      { id: "EARTHQUAKE", name: "Earthquake", nameCn: "Âú∞Èúá", img: "ball_icon_earthquake.png", effectCn: "ÈÄ†ÊàêËåÉÂõ¥ÊÄßÁöÑÂú∞Èù¢ÂÜ≤ÂáªÂíå‰º§ÂÆ≥„ÄÇ" },
      { id: "EGG_SAC", name: "Egg Sac", nameCn: "ÂçµÂõä", img: "ball_icon_egg_sac.png", effectCn: "ÂèØ‰ª•Â≠µÂåñÂá∫Â∞èÂûãÁîüÁâ©ÁöÑÂçµÂõä„ÄÇ" },
      { id: "FREEZE", name: "Freeze", nameCn: "ÂÜ∞ÂÜª", img: "ball_icon_freeze.png", effectCn: "ÊîªÂáªÂèØ‰ª•ÂÜ∞ÂÜªÊàñÂáèÈÄüÊïå‰∫∫„ÄÇ" },
      { id: "GHOST", name: "Ghost", nameCn: "ÂπΩÁÅµ", img: "ball_icon_ghost.png", effectCn: "ÂèØ‰ª•Á©øÈÄèÊïå‰∫∫ÔºåÈÄ†ÊàêÈöæ‰ª•Èò≤Âæ°ÁöÑ‰º§ÂÆ≥„ÄÇ" },
      { id: "IRON", name: "Iron", nameCn: "Èí¢ÈìÅ", img: "ball_icon_iron.png", effectCn: "ÂùöÁ°¨ÁöÑÂºπÁè†ÔºåÈÄöÂ∏∏ÂÖ∑ÊúâÊõ¥È´òÁöÑÂü∫Á°Ä‰º§ÂÆ≥ÊàñÁ†¥Áî≤ÊïàÊûú„ÄÇ" },
      { id: "LASER_H", name: "Laser H", nameCn: "ÊøÄÂÖâ(Ê®™)", img: "ball_icon_laser_horizontal.png", effectCn: "ÂèëÂ∞Ñ‰∏ÄÈÅìÁõ¥Á∫øÊøÄÂÖâÔºåÁ©øÈÄèË∑ØÂæÑ‰∏äÁöÑÊâÄÊúâÊïå‰∫∫„ÄÇ" },
      { id: "LASER_V", name: "Laser V", nameCn: "ÊøÄÂÖâ(Á´ñ)", img: "ball_icon_laser_vertical.png", effectCn: "ÂèëÂ∞Ñ‰∏ÄÈÅìÁõ¥Á∫øÊøÄÂÖâÔºåÁ©øÈÄèË∑ØÂæÑ‰∏äÁöÑÊâÄÊúâÊïå‰∫∫„ÄÇ" },
      { id: "LIGHT", name: "Light", nameCn: "ÂÖâÊòé", img: "ball_icon_light.png", effectCn: "ËøêÁî®ÂÖâÊòéÂäõÈáèÔºåÈÄöÂ∏∏Â∏¶ÊúâÊ≤ªÁñóÊàñËá¥Áõ≤ÊïàÊûú„ÄÇ" },
      { id: "LIGHTNING", name: "Lightning", nameCn: "Èó™Áîµ", img: "ball_icon_lightning.png", effectCn: "ÊîªÂáªÂèØ‰ª•ÈáäÊîæËøûÈîÅÈó™ÁîµÔºåÂºπÂ∞ÑÂà∞Â§ö‰∏™Êïå‰∫∫Ë∫´‰∏ä„ÄÇ" },
      { id: "POISON", name: "Poison", nameCn: "ÊØí", img: "ball_icon_poison.png", effectCn: "ÊîªÂáª‰ºö‰ΩøÊïå‰∫∫‰∏≠ÊØíÔºåÂú®ÈïøÊó∂Èó¥ÂÜÖÈÄ†ÊàêÊåÅÁª≠‰º§ÂÆ≥„ÄÇ" },
      { id: "VAMPIRE", name: "Vampire", nameCn: "Âê∏Ë°ÄÈ¨º", img: "ball_icon_vampire.png", effectCn: "ÊîªÂáªÂèØ‰ª•Â∞ÜÈÄ†ÊàêÁöÑÈÉ®ÂàÜ‰º§ÂÆ≥ËΩ¨Âåñ‰∏∫Ëá™Ë∫´ÁîüÂëΩÂÄº„ÄÇ" },
      { id: "WIND", name: "Wind", nameCn: "È£é", img: "ball_icon_wind.png", effectCn: "ÂèØ‰ª•ÂêπÈ£ûÊïå‰∫∫ÊàñÂ¢ûÂº∫ÂÖ∂‰ªñÂÖÉÁ¥†ÊïàÊûúÁöÑËåÉÂõ¥„ÄÇ" }
    ];

    const EVOLUTIONS = [
      // Âü∫Á°ÄËøõÂåñ
      { name: "Leech", nameCn: "Ê∞¥Ëõ≠", row: "BLEED", col: "BROOD_MOTHER", img: "ball_icon_leech.png", effectCn: "ÁêÉÂáª‰∏≠Êïå‰∫∫ÂêéÔºå‰ºöÈôÑÁùÄÂú®ÂÖ∂Ë∫´‰∏äÔºåÊØèÁßíÈÄ†Êàê‰º§ÂÆ≥„ÄÇ" },
      { name: "Berserk", nameCn: "ÁãÇÊö¥", row: "CHARM", col: "BLEED", img: "ball_icon_berserk.png", effectCn: "Êö¥ÊÄíÔºå‰º§ÂÆ≥Â¢ûÂä†100%„ÄÇ", alt: true },
      { name: "Berserk", nameCn: "ÁãÇÊö¥", row: "CHARM", col: "BURN", img: "ball_icon_berserk.png", effectCn: "Êö¥ÊÄíÔºå‰º§ÂÆ≥Â¢ûÂä†100%„ÄÇ", alt: true },
      { name: "Sacrifice", nameCn: "ÁåÆÁ•≠", row: "BLEED", col: "DARK", img: "ball_icon_sacrifice.png", effectCn: "ÂØπÊïå‰∫∫ÈÄ†Êàê4Â±ÇÊµÅË°ÄÊïàÊûúÔºå‰∏äÈôê‰∏∫15Â±Ç„ÄÇÊñΩÂä†ËØÖÂííÔºå5Ê¨°ÊîªÂáªÂêéÈÄ†ÊàêÂ§ßÈáè‰º§ÂÆ≥„ÄÇ" },
      { name: "Hemorrhage", nameCn: "Â§ßÂá∫Ë°Ä", row: "BLEED", col: "IRON", img: "ball_icon_hemorrhage.png", effectCn: "Á©øÈÄèÊïå‰∫∫ÁöÑÊä§Áî≤Âπ∂ÈÄ†Êàê‰º§ÂÆ≥„ÄÇ" },
      { name: "Vampire Lord", nameCn: "Âê∏Ë°ÄÈ¨ºÈ¢Ü‰∏ª", row: "BLEED", col: "VAMPIRE", img: "ball_icon_vampire_lord.png", effectCn: "ÁªàÊûÅÂê∏Ë°ÄÈ¨ºÔºåÂ∞ÜÂØπÊïå‰∫∫ÈÄ†ÊàêÁöÑ‰º§ÂÆ≥ËΩ¨Âåñ‰∏∫ÁîüÂëΩÂÄº„ÄÇÁêÉ‰ºö‰∏çÊó∂‰∫ßÁîüËùôËù†ÔºåÊîªÂáªÈôÑËøëÁöÑÊïå‰∫∫„ÄÇ" },
      { name: "Maggot", nameCn: "ËõÜËô´", row: "BROOD_MOTHER", col: "CELL", img: "ball_icon_maggot.png", effectCn: "ÂêëÊïå‰∫∫ÂèëÂ∞ÑËõÜËô´ÔºåÊïå‰∫∫Ê≠ª‰∫°Êó∂‰ºöÁîüÂá∫Â∞èÁêÉ„ÄÇ" },
      { name: "Spider Queen", nameCn: "ËúòËõõÂ•≥Áéã", row: "BROOD_MOTHER", col: "EGG_SAC", img: "ball_icon_spider_queen.png", effectCn: "ÊØèÈöî‰∏ÄÊÆµÊó∂Èó¥‰∫ßÁîüËúòËõõÂçµÔºåÂ≠µÂåñÂá∫ÁöÑËúòËõõ‰ºöÊîªÂáªÈôÑËøëÁöÑÊïå‰∫∫„ÄÇ" },
      { name: "Mosquito King", nameCn: "ËöäÁéã", row: "BROOD_MOTHER", col: "VAMPIRE", img: "ball_icon_mosquito_king.png", effectCn: "Âè¨Âî§ËöäÂ≠êÊîªÂáªÊïå‰∫∫ÔºåÂ∞ÜÈÄ†ÊàêÁöÑ‰º§ÂÆ≥ËΩ¨Âåñ‰∏∫ÁîüÂëΩÂÄº„ÄÇ" },
      { name: "Magma", nameCn: "Â≤©ÊµÜ", row: "BURN", col: "EARTHQUAKE", img: "ball_icon_magma.png", effectCn: "ÊØèÈöî‰∏ÄÊÆµÊó∂Èó¥Âñ∑Âá∫Â≤©ÊµÜÂùóÔºåÂØπÊïå‰∫∫ÈÄ†Êàê‰º§ÂÆ≥Âπ∂ÊñΩÂä†ÊúÄÂ§ö3Â±ÇÁÅºÁÉßÊïàÊûú„ÄÇ" },
      { name: "Frozen Flame", nameCn: "ÂÜ∞ÂÜªÁÅ´ÁÑ∞", row: "BURN", col: "FREEZE", img: "ball_icon_frozen_flame.png", effectCn: "ÂØπÊïå‰∫∫ÈÄ†ÊàêÂÜ∞ÁÅ´ÂèåÈáç‰º§ÂÆ≥„ÄÇ" },
      { name: "Bomb", nameCn: "ÁÇ∏Âºπ", row: "BURN", col: "IRON", img: "ball_icon_bomb.png", effectCn: "Âáª‰∏≠Êïå‰∫∫Êó∂‰ºöÂèëÁîüÁàÜÁÇ∏ÔºåÂØπÁàÜÁÇ∏ËåÉÂõ¥ÂÜÖÁöÑÊâÄÊúâÊïå‰∫∫ÈÄ†Êàê‰º§ÂÆ≥„ÄÇ" },
      { name: "Sun", nameCn: "Â§™Èò≥", row: "BURN", col: "LIGHT", img: "ball_icon_sun.png", effectCn: "ÂåñË∫´‰∏∫Â§™Èò≥ÔºåÁÅºÁÉßÂë®Âõ¥ÁöÑÊïå‰∫∫„ÄÇ" },
      { name: "Inferno", nameCn: "ÁÇºÁã±", row: "BURN", col: "WIND", img: "ball_icon_inferno.png", effectCn: "ÂØπÂçäÂæÑ2Ê†ºÂÜÖÁöÑÊïå‰∫∫ÊñΩÂä†1Â±ÇÁÅºÁÉßÊïàÊûúÔºåÊåÅÁª≠6Áßí„ÄÇ" },
      { name: "Overgrowth", nameCn: "ËøáÂ∫¶ÁîüÈïø", row: "CELL", col: "EARTHQUAKE", img: "ball_icon_overgrowth.png", effectCn: "‰ªéÂú∞Èù¢Âè¨Âî§ËçÜÊ£òÔºåÂØπÂ§ßËåÉÂõ¥ÂÜÖÁöÑÊïå‰∫∫ÈÄ†Êàê‰º§ÂÆ≥„ÄÇ" },
      { name: "Radiation Beam", nameCn: "ËæêÂ∞ÑÂÖâÊùü", row: "CELL", col: "LASER_H", img: "ball_icon_radiation_beam.png", effectCn: "ÊøÄÂÖâÊùü‰ºöÈÄ†ÊàêËæêÂ∞Ñ‰º§ÂÆ≥„ÄÇ", alt: true },
      { name: "Virus", nameCn: "ÁóÖÊØí", row: "CELL", col: "POISON", img: "ball_icon_vrius.png", effectCn: "ÊÑüÊüìÊïå‰∫∫ÔºåÁóÖÊØí‰ºöÂú®Êïå‰∫∫‰πãÈó¥‰º†Êí≠ÔºåÂπ∂ÊåÅÁª≠ÈÄ†Êàê‰º§ÂÆ≥„ÄÇ", alt: true },
      { name: "Incubus", nameCn: "Ê¢¶È≠á", row: "CHARM", col: "DARK", img: "ball_icon_incubus.png", effectCn: "Ëø∑ÊÉëÊïå‰∫∫Ôºå‰ΩøÂÖ∂Âú®Áü≠Êó∂Èó¥ÂÜÖ‰∏∫‰Ω†‰ΩúÊàò„ÄÇ" },
      { name: "Lovestruck", nameCn: "ÁÉ≠ÊÅã", row: "CHARM", col: "LIGHT", img: "ball_icon_lovestruck.png", effectCn: "ËÆ©Êïå‰∫∫Èô∑ÂÖ•Áà±Ê≤≥Ôºå‰ΩøÂÖ∂ÂÅúÊ≠¢ÊîªÂáªÂπ∂Èôç‰ΩéÈò≤Âæ°Âäõ„ÄÇ", alt: true },
      { name: "Succubus", nameCn: "È≠ÖÈ≠î", row: "CHARM", col: "VAMPIRE", img: "ball_icon_succubus.png", effectCn: "ÂºïËØ±Êïå‰∫∫ÔºåÂê∏ÂèñÂÖ∂ÁîüÂëΩÁ≤æÂçé‰∏∫‰Ω†ÊÅ¢Â§çÁîüÂëΩÂÄº„ÄÇ" },
      { name: "Phantom", nameCn: "ÂπªÂΩ±", row: "DARK", col: "GHOST", img: "ball_icon_phantom.png", effectCn: "ËôöÊó†ÂΩ¢ÊÄÅÔºåÂèØÁ©øËøáÊïå‰∫∫„ÄÇ" },
      { name: "Assassin", nameCn: "Âà∫ÂÆ¢", row: "DARK", col: "IRON", img: "ball_icon_dark_assassin.png", effectCn: "ÂØπÁîüÂëΩÂÄº‰Ωé‰∫é20%ÁöÑÊïå‰∫∫ÈÄ†ÊàêËá¥ÂëΩ‰∏ÄÂáª„ÄÇ", alt: true },
      { name: "Flicker", nameCn: "Èó™ÁÉÅ", row: "DARK", col: "LIGHT", img: "ball_icon_flicker.png", effectCn: "ÊØèÈöîÂá†ÁßíÂØπÂ±èÂπï‰∏äÁöÑÊâÄÊúâÊïå‰∫∫ÈÄ†Êàê‰º§ÂÆ≥„ÄÇ" },
      { name: "Noxious", nameCn: "ÂâßÊØí", row: "DARK", col: "WIND", img: "ball_icon_noxious.png", effectCn: "Âà∂ÈÄ†‰∏ÄÂõ¢ÊØí‰∫ëÔºåÈöèÈ£éÈ£òÊï£ÔºåÂØπ‰∫ë‰∏≠ÁöÑÊâÄÊúâÊïå‰∫∫ÈÄ†ÊàêÊåÅÁª≠‰º§ÂÆ≥„ÄÇ", alt: true },
      { name: "Glacier", nameCn: "ÂÜ∞Â∑ù", row: "EARTHQUAKE", col: "FREEZE", img: "ball_icon_glacier.png", effectCn: "ÊØèÈöî‰∏ÄÊÆµÊó∂Èó¥ÈáäÊîæÂÜ∞Â∑ùÂ∞ñÂà∫ÔºåÂØπÊïå‰∫∫ÈÄ†Êàê‰º§ÂÆ≥Âπ∂ÂÜ∞ÂÜªÊïå‰∫∫„ÄÇ" },
      { name: "Swamp", nameCn: "Ê≤ºÊ≥Ω", row: "EARTHQUAKE", col: "POISON", img: "ball_icon_swamp.png", effectCn: "Â∞ÜÂú∞Èù¢Âèò‰∏∫ÂâßÊØíÊ≤ºÊ≥ΩÔºåÂáèÈÄüÂπ∂ÊåÅÁª≠ÊØíÂÆ≥ÂÖ∂‰∏≠ÁöÑÊâÄÊúâÊïå‰∫∫„ÄÇ" },
      { name: "Sandstorm", nameCn: "Ê≤ôÂ∞òÊö¥", row: "EARTHQUAKE", col: "WIND", img: "ball_icon_sandstorm.png", effectCn: "Á©øËøáÊïå‰∫∫Êó∂ÔºåÊØèÁßíÂØπÊïå‰∫∫ÈÄ†ÊàêÂ§ßÈáè‰º§ÂÆ≥„ÄÇ" },
      { name: "Shotgun", nameCn: "Èú∞ÂºπÊû™", row: "IRON", col: "EGG_SAC", img: "ball_icon_shotgun.png", effectCn: "ÂèëÂ∞ÑÂ§ö‰∏™ÊäïÂ∞ÑÁâ©„ÄÇ" },
      { name: "Wraith", nameCn: "ÊÄ®ÁÅµ", row: "FREEZE", col: "GHOST", img: "ball_icon_wraith.png", effectCn: "Á©øËøáÊïå‰∫∫Êó∂ÂÜ∞ÂÜªÊïå‰∫∫„ÄÇ" },
      { name: "Freeze Ray", nameCn: "ÂÜ∞ÂÜªÂ∞ÑÁ∫ø", row: "FREEZE", col: "LASER_H", img: "ball_icon_freeze_ray.png", effectCn: "ÂèëÂ∞Ñ‰∏ÄÈÅìÊøÄÂÖâÔºåÂÜªÁªìË∑ØÂæÑ‰∏äÁöÑÊïå‰∫∫„ÄÇ" },
      { name: "Blizzard", nameCn: "Êö¥È£éÈõ™", row: "FREEZE", col: "WIND", img: "ball_icon_blizzard.png", effectCn: "Âú®Â∞èËåÉÂõ¥ÂÜÖÂÜªÁªìÊâÄÊúâÊïå‰∫∫ÔºåÂπ∂ÈÄ†Êàê‰º§ÂÆ≥„ÄÇ", alt: true },
      { name: "Soul Sucker", nameCn: "ÁÅµÈ≠ÇÂê∏ÂèñËÄÖ", row: "GHOST", col: "VAMPIRE", img: "ball_icon_soul_sucker.png", effectCn: "Áõ¥Êé•‰ªéÊïå‰∫∫Ë∫´‰∏äÂê∏ÂèñÁÅµÈ≠ÇÔºåÈÄ†Êàê‰º§ÂÆ≥Âπ∂‰∏∫‰Ω†ÊÅ¢Â§çÁîüÂëΩÂÄº„ÄÇ" },
      { name: "Holy Laser", nameCn: "Á•ûÂú£ÊøÄÂÖâ", row: "LASER_V", col: "LASER_H", img: "ball_icon_holy_laser.png", effectCn: "ÂØπÂêå‰∏ÄË°åÂíåÂêå‰∏ÄÂàóÁöÑÊâÄÊúâÊïå‰∫∫ÈÄ†Êàê‰º§ÂÆ≥„ÄÇ" },
      { name: "Laser Beam", nameCn: "ÊøÄÂÖâÊùü", row: "LASER_H", col: "LIGHT", img: "ball_icon_laser_beam.png", effectCn: "Âº∫ÂåñÊøÄÂÖâÔºå‰ΩøÂÖ∂Êõ¥Á≤ó„ÄÅ‰º§ÂÆ≥Êõ¥È´òÔºåÂπ∂ËÉΩÁÇπÁáÉÊïå‰∫∫ÈÄ†ÊàêÊåÅÁª≠‰º§ÂÆ≥„ÄÇ" },
      { name: "Flash", nameCn: "Èó™ÂÖâ", row: "LIGHT", col: "LIGHTNING", img: "ball_icon_flash.png", effectCn: "‰ª•Èó™ÁîµËà¨ÁöÑÈÄüÂ∫¶ÁßªÂä®ÂíåÊîªÂáª„ÄÇ" },
      { name: "Lightning Rod", nameCn: "ÈÅøÈõ∑Èíà", row: "LIGHTNING", col: "IRON", img: "ball_pit_lightning_rod.png", effectCn: "Âú®Âáª‰∏≠ÁÇπÂΩ¢Êàê‰∏Ä‰∏™ÈÅøÈõ∑ÈíàÔºåÊåÅÁª≠Âê∏ÂºïÈó™ÁîµÊîªÂáªÂë®Âõ¥ÁöÑÊïå‰∫∫„ÄÇ" },
      { name: "Storm", nameCn: "È£éÊö¥", row: "LIGHTNING", col: "WIND", img: "ball_icon_storm.png", effectCn: "ÈáäÊîæÈó™ÁîµÊîªÂáªÈôÑËøëÁöÑÊïå‰∫∫„ÄÇ" },
      { name: "Mosquito Swarm", nameCn: "ËöäÁæ§", row: "VAMPIRE", col: "EGG_SAC", img: "ball_icon_mosquito_swarm_erfffn.png", effectCn: "Âáª‰∏≠Êó∂ÁàÜË£ÇÊàêÂ§öÂè™ËöäÂ≠ê„ÄÇ" },
      { name: "Voluptuous Egg Sac", nameCn: "‰∏∞Êª°ÂçµÂõä", row: "EGG_SAC", col: "CELL", img: "ball_icon_voluptuous_egg_sac.png", effectCn: "ÁàÜË£ÇÊàêÂ§ö‰∏™ÂçµÂõä„ÄÇ" }
    ];

    const ADVANCED_EVOLUTIONS = [
      { name: "Nuclear Bomb", nameCn: "Ê†∏Âºπ", components: ["Bomb", "Poison"], img: "ball_icon_nuclear_bomb.png", effectCn: "Âà∂ÈÄ†‰∏ÄÂú∫Â∑®Â§ßÁöÑÊ†∏ÁàÜÔºåÂØπÂÖ®Â±èÊïå‰∫∫ÈÄ†ÊàêÈ´òÈ¢ùÂàùÂßã‰º§ÂÆ≥ÔºåÂπ∂Âú®ÂêéÁª≠Áïô‰∏ãÂº∫ÁÉàÁöÑËæêÂ∞ÑÂå∫ÂüüÊåÅÁª≠ÈÄ†Êàê‰º§ÂÆ≥„ÄÇ" },
      { name: "Black Hole", nameCn: "ÈªëÊ¥û", components: ["Sun", "Dark"], img: "ball_icon_black_hole.png", effectCn: "Âú®Â±èÂπï‰∏äÂàõÂª∫‰∏Ä‰∏™Âº∫Â§ßÁöÑÂºïÂäõÂ•áÁÇπÔºåÂ∞ÜÂë®Âõ¥ÁöÑÊïå‰∫∫ÂíåÊäïÂ∞ÑÁâ©ÂÖ®ÈÉ®Âê∏ÂÖ•Âπ∂ÊπÆÁÅ≠„ÄÇ" },
      { name: "Satan", nameCn: "ÊííÊó¶", components: ["Incubus", "Succubus"], img: "ball_icon_satan.png", effectCn: "Âè¨Âî§ÊÅ∂È≠î‰πãÁéãÊííÊó¶ÔºåÂêåÊó∂Êã•ÊúâÊ¢¶È≠áÁöÑÊéßÂà∂ÂíåÈ≠ÖÈ≠îÁöÑÂê∏ÂèñËÉΩÂäõÔºåÊòØÊàòÂú∫‰∏äÁöÑÁªàÊûÅ‰∏ªÂÆ∞„ÄÇ" },
      { name: "Nosferatu", nameCn: "ËØ∫ÊñØË¥πÊãâÂõæ", components: ["Vampire Lord", "Mosquito King", "Spider Queen"], img: "ball_icon_nosferatu.png", effectCn: "Âê∏Ë°ÄÈ¨º„ÄÅËöäÂ≠êÂíåËúòËõõÁöÑÁªàÊûÅËûçÂêà‰ΩìÔºåÊã•ÊúâÊó†‰∏é‰º¶ÊØîÁöÑÁîüÂëΩÊ±≤ÂèñËÉΩÂäõÂíå‰ªÜ‰ªéÂ§ßÂÜõÔºåÊòØÁúüÊ≠£ÁöÑ‰∏çÊ≠ªÂêõÁéã„ÄÇ" }
    ];

    const PASSIVE_EVOLUTIONS = [
      { name: "Soul Reaver", nameCn: "ÁÅµÈ≠ÇÊé†Â§∫ËÄÖ", components: ["Everflowing Goblet", "Vampiric Sword"], img: "soulReaver.png", effectCn: "ÊûÅÂ§ßÂú∞Â¢ûÂº∫‰Ω†ÁöÑÁîüÂëΩÂÅ∑ÂèñÊïàÊûúÔºåÂπ∂Â∞ÜÊ∫¢Âá∫ÁöÑÊ≤ªÁñóÈáèËΩ¨Âåñ‰∏∫‰∏Ä‰∏™ÂèØ‰ª•Âê∏Êî∂‰º§ÂÆ≥ÁöÑÊä§Áõæ„ÄÇ" },
      { name: "Cornucopia", nameCn: "‰∏∞È•∂‰πãËßí", components: ["Baby Rattle", "War Horn"], img: "cornucopia.png", effectCn: "Âë®ÊúüÊÄßÂú∞‰∫ßÁîüÂêÑÁßçËµÑÊ∫êÔºåÂåÖÊã¨ÈáëÂ∏Å„ÄÅÂÆùÁü≥ÂíåÁîüÂëΩÊÅ¢Â§çÔºåÊòØÊåÅÁª≠‰ΩúÊàòÁöÑÂº∫Â§ß‰øùÈöú„ÄÇ" },
      { name: "Phantom Regalia", nameCn: "ÂπªÂΩ±ÁéãÊùÉ", components: ["Ethereal Cloak", "Ghostly Corset"], img: "phantomRegalia.png", effectCn: "Êèê‰æõÊûÅÈ´òÁöÑÈó™ÈÅøÂá†ÁéáÔºåÂπ∂ËÆ©‰Ω†Âú®Èó™ÈÅøÊàêÂäüÂêéÁü≠ÊöÇËøõÂÖ•Êó†ÊïåÁä∂ÊÄÅ„ÄÇ" },
      { name: "Odiferous Shell", nameCn: "ÊÅ∂Ëá≠‰πãÂ£≥", components: ["Breastplate", "Corrupted Onion"], img: "odiferousShell.png", effectCn: "ÂΩì‰Ω†ÂèóÂà∞‰º§ÂÆ≥Êó∂Ôºå‰ºöÈáäÊîæÂá∫‰∏ÄËÇ°ÊÅ∂Ëá≠ÔºåÂØπÂë®Âõ¥ÁöÑÊïå‰∫∫ÈÄ†Êàê‰º§ÂÆ≥Âπ∂Èôç‰ΩéÂÖ∂ÊîªÂáªÂäõ„ÄÇ" },
      { name: "Gracious Impaler", nameCn: "‰ºòÈõÖÁ©øÂà∫ËÄÖ", components: ["Reacher's Spear", "Deadeye's Amulet"], img: "graciousImpaler.png", effectCn: "‰Ω†ÁöÑÊâÄÊúâÊäïÂ∞ÑÁâ©ÈÉΩÂ∞ÜËé∑ÂæóÁ©øÈÄèÊïàÊûúÔºåÂπ∂ÂØπË¢´Á©øÈÄèÁöÑÊØè‰∏™Êïå‰∫∫ÈÄ†ÊàêÈÄíÂ¢ûÁöÑ‰º§ÂÆ≥„ÄÇ" },
      { name: "Tormentor's Mask", nameCn: "ÊäòÁ£®ËÄÖÈù¢ÂÖ∑", components: ["Crown of Thorns", "Spiked Collar"], img: "tormentorsMask.png", effectCn: "Â∞Ü‰Ω†ÂèóÂà∞ÁöÑÈÉ®ÂàÜ‰º§ÂÆ≥ÂèçÂºπÁªôÊîªÂáªËÄÖÔºåÂπ∂‰∏î‰Ω†ÁöÑÊîªÂáª‰ºöÂØπÁîüÂëΩÂÄº‰Ωé‰∫é50%ÁöÑÊïå‰∫∫ÈÄ†ÊàêÈ¢ùÂ§ñ‰º§ÂÆ≥„ÄÇ" },
      { name: "Wings of the Anointed", nameCn: "ÂèóËÜèËÄÖ‰πãÁøº", components: ["Fleet Feet", "Radiant Feather"], img: "wingsOfTheAnnointed.png", effectCn: "ÊûÅÂ§ßÂú∞ÊèêÂçá‰Ω†ÁöÑÁßªÂä®ÈÄüÂ∫¶ÔºåÂπ∂ËÆ©‰Ω†ËÉΩÂ§üÂÖçÁñ´Âú∞Èù¢‰∏äÁöÑÈô∑Èò±ÂíåÂáèÈÄüÊïàÊûú„ÄÇ" },
      { name: "Deadeye's Cross", nameCn: "Á•ûÂ∞ÑÊâãÂçÅÂ≠ó", components: ["All 4 Daggers"], img: "deadeyesCross.png", effectCn: "ËûçÂêàÂõõÊääÂÖÉÁ¥†ÂåïÈ¶ñÁöÑÂäõÈáèÔºåÂ§ßÂπÖÊèêÂçáÊö¥ÂáªÁéá„ÄÅÊö¥Âáª‰º§ÂÆ≥ÂíåÊäïÂ∞ÑÁâ©ÈÄüÂ∫¶ÔºåÊØè‰∏ÄÂáªÈÉΩÁ≤æÂáÜËÄåËá¥ÂëΩ„ÄÇ" }
    ];

    // ========== ÂÖ®Â±ÄÂèòÈáè ==========
    let currentLang = 'cn';
    let currentView = 'matrix';
    const IMG_BASE = 'img/';

    // ========== Â∑•ÂÖ∑ÂáΩÊï∞ ==========
    function getImg(filename) {
      if (!filename) return IMG_BASE + 'ball_icon_bleed.png';
      return IMG_BASE + filename;
    }

    function getName(item) {
      return currentLang === 'cn' ? (item.nameCn || item.name) : item.name;
    }

    function getEffect(item) {
      return currentLang === 'cn' ? (item.effectCn || item.effect) : item.effect;
    }

    function getBaseBall(id) {
      return BASE_BALLS.find(b => b.id === id);
    }

    function getEvolution(name) {
      return EVOLUTIONS.find(e => e.name === name) || 
             ADVANCED_EVOLUTIONS.find(e => e.name === name) ||
             PASSIVE_EVOLUTIONS.find(e => e.name === name);
    }

    function findEvolution(rowId, colId) {
      return EVOLUTIONS.find(e => 
        (e.row === rowId && e.col === colId) || 
        (e.row === colId && e.col === rowId)
      );
    }

    // ========== Áü©ÈòµËßÜÂõæ ==========
    function renderMatrix() {
      const table = document.getElementById('matrixTable');
      let html = '<tr><th></th>';
      
      // Ë°®Â§¥
      BASE_BALLS.forEach(ball => {
        html += `<th onmouseenter="showTooltip(event, '${ball.id}', 'base')" onmouseleave="hideTooltip()">
          <img src="${getImg(ball.img)}" alt="${ball.name}" onerror="this.src='${getImg('placeholder.png')}'">
          <span>${getName(ball)}</span>
        </th>`;
      });
      html += '</tr>';

      // Ë°®‰Ωì
      BASE_BALLS.forEach(rowBall => {
        html += `<tr><th onmouseenter="showTooltip(event, '${rowBall.id}', 'base')" onmouseleave="hideTooltip()">
          <img src="${getImg(rowBall.img)}" alt="${rowBall.name}" onerror="this.src='${getImg('placeholder.png')}'">
          <span>${getName(rowBall)}</span>
        </th>`;

        BASE_BALLS.forEach(colBall => {
          const evo = findEvolution(rowBall.id, colBall.id);
          if (evo) {
            html += `<td class="matrix-cell" data-evo="${evo.name}" onmouseenter="showTooltip(event, '${evo.name}', 'evo')" onmouseleave="hideTooltip()">
              <img src="${getImg(evo.img)}" alt="${evo.name}" onerror="this.src='${getImg('placeholder.png')}'">
              <div class="cell-name">${getName(evo)}${evo.alt ? '*' : ''}</div>
            </td>`;
          } else {
            html += `<td class="matrix-cell empty"></td>`;
          }
        });

        html += '</tr>';
      });

      table.innerHTML = html;
    }

    // ========== ÂàóË°®ËßÜÂõæ ==========
    function renderList() {
      const container = document.getElementById('listContainer');
      let html = '';

      BASE_BALLS.forEach(baseBall => {
        const combos = EVOLUTIONS.filter(e => e.row === baseBall.id || e.col === baseBall.id);
        if (combos.length === 0) return;

        html += `<div class="list-card">
          <div class="list-card-header">
            <img src="${getImg(baseBall.img)}" alt="${baseBall.name}" onerror="this.src='${getImg('placeholder.png')}'">
            <div>
              <h3>${getName(baseBall)}</h3>
              <div class="subtitle">${combos.length} ${currentLang === 'cn' ? 'ÁßçÁªÑÂêà' : 'combinations'}</div>
            </div>
          </div>
          <div class="list-card-body">`;

        combos.forEach(evo => {
          const partnerId = evo.row === baseBall.id ? evo.col : evo.row;
          const partner = getBaseBall(partnerId);
          if (!partner) return;

          html += `<div class="combo-item" onclick="openModal('${evo.name}')">
            <img src="${getImg(evo.img)}" alt="${evo.name}" onerror="this.src='${getImg('placeholder.png')}'">
            <div class="combo-text">
              <span class="partner">+ ${getName(partner)}</span>
              <span class="arrow">‚Üí</span>
              <span class="result">${getName(evo)}${evo.alt ? '*' : ''}</span>
            </div>
          </div>`;
        });

        html += '</div></div>';
      });

      container.innerHTML = html;
    }

    // ========== ÂõæÈâ¥ËßÜÂõæ ==========
    function renderGallery() {
      // Âü∫Á°ÄÁêÉ
      let basicHtml = '';
      BASE_BALLS.forEach(ball => {
        basicHtml += `<div class="gallery-item" onmouseenter="showTooltip(event, '${ball.id}', 'base')" onmouseleave="hideTooltip()">
          <img src="${getImg(ball.img)}" alt="${ball.name}" onerror="this.src='${getImg('placeholder.png')}'">
          <div class="item-name">${ball.name}</div>
          <div class="item-name-cn">${ball.nameCn || ''}</div>
        </div>`;
      });
      document.getElementById('galleryBasic').innerHTML = basicHtml;

      // ËøõÂåñÁêÉ
      let evolvedHtml = '';
      const uniqueEvos = [];
      EVOLUTIONS.forEach(evo => {
        if (!uniqueEvos.find(e => e.name === evo.name)) {
          uniqueEvos.push(evo);
        }
      });
      uniqueEvos.forEach(evo => {
        evolvedHtml += `<div class="gallery-item" onmouseenter="showTooltip(event, '${evo.name}', 'evo')" onmouseleave="hideTooltip()">
          <img src="${getImg(evo.img)}" alt="${evo.name}" onerror="this.src='${getImg('placeholder.png')}'">
          <div class="item-name">${evo.name}</div>
          <div class="item-name-cn">${evo.nameCn || ''}</div>
        </div>`;
      });
      document.getElementById('galleryEvolved').innerHTML = evolvedHtml;

      // È´òÁ∫ßËøõÂåñ
      let advancedHtml = '';
      ADVANCED_EVOLUTIONS.forEach(evo => {
        advancedHtml += `<div class="gallery-item" onmouseenter="showTooltip(event, '${evo.name}', 'evo')" onmouseleave="hideTooltip()">
          <img src="${getImg(evo.img)}" alt="${evo.name}" onerror="this.src='${getImg('placeholder.png')}'">
          <div class="item-name">${evo.name}</div>
          <div class="item-name-cn">${evo.nameCn || ''}</div>
        </div>`;
      });
      document.getElementById('galleryAdvanced').innerHTML = advancedHtml;

      // Ë¢´Âä®ÈÅìÂÖ∑
      let passiveHtml = '';
      PASSIVE_EVOLUTIONS.forEach(evo => {
        passiveHtml += `<div class="gallery-item" onmouseenter="showTooltip(event, '${evo.name}', 'evo')" onmouseleave="hideTooltip()">
          <img src="${getImg(evo.img)}" alt="${evo.name}" onerror="this.src='${getImg('placeholder.png')}'">
          <div class="item-name">${evo.name}</div>
          <div class="item-name-cn">${evo.nameCn || ''}</div>
        </div>`;
      });
      document.getElementById('galleryPassive').innerHTML = passiveHtml;
    }

    // ========== È´òÁ∫ß/Ë¢´Âä®ËøõÂåñÂå∫ ==========
    function renderAdvancedSections() {
      // È´òÁ∫ßËøõÂåñ
      const advGrid = document.getElementById('advancedGrid');
      let advHtml = '';
      ADVANCED_EVOLUTIONS.forEach(evo => {
        advHtml += `<div class="advanced-card" onmouseenter="showTooltip(event, '${evo.name}', 'evo')" onmouseleave="hideTooltip()">
          <img src="${getImg(evo.img)}" alt="${evo.name}" onerror="this.src='${getImg('placeholder.png')}'">
          <div class="advanced-card-info">
            <h4>${getName(evo)}</h4>
            <p>${evo.components.join(' + ')}</p>
          </div>
        </div>`;
      });
      advGrid.innerHTML = advHtml;

      // Ë¢´Âä®ËøõÂåñ
      const passGrid = document.getElementById('passiveGrid');
      let passHtml = '';
      PASSIVE_EVOLUTIONS.forEach(evo => {
        passHtml += `<div class="advanced-card" onmouseenter="showTooltip(event, '${evo.name}', 'evo')" onmouseleave="hideTooltip()">
          <img src="${getImg(evo.img)}" alt="${evo.name}" onerror="this.src='${getImg('placeholder.png')}'">
          <div class="advanced-card-info">
            <h4>${getName(evo)}</h4>
            <p>${evo.components.join(' + ')}</p>
          </div>
        </div>`;
      });
      passGrid.innerHTML = passHtml;
    }

    // ========== ÊÇ¨ÊµÆÊèêÁ§∫Ê°Ü ==========
    // type: 'base' Êàñ 'evo'
    function showTooltip(event, name, type) {
      let item = null;
      if (type === 'base') {
        item = getBaseBall(name);
      }
      else {
        item = getEvolution(name);
      }
      if (!item) return;

      const tooltip = document.getElementById('tooltip');
      
      // Â°´ÂÖÖÂÜÖÂÆπ
      document.getElementById('tooltipImg').src = getImg(item.img);
      document.getElementById('tooltipTitle').textContent = item.name;
      document.getElementById('tooltipTitleCn').textContent = item.nameCn || '';
      document.getElementById('tooltipEffect').textContent = getEffect(item);

      // ÊûÑÂª∫ÈÖçÊñπ(Âü∫Á°ÄÁêÉÊ≤°ÊúâÈÖçÊñπ)
      let formulaHtml = '';
      if (item.row && item.col) {
        const ball1 = getBaseBall(item.row);
        const ball2 = getBaseBall(item.col);
        if (ball1) {
          formulaHtml += `<img src="${getImg(ball1.img)}" alt="${ball1.name}">`;
          formulaHtml += `<span>${getName(ball1)}</span>`;
        }
        formulaHtml += '<span class="plus">+</span>';
        if (ball2) {
          formulaHtml += `<img src="${getImg(ball2.img)}" alt="${ball2.name}">`;
          formulaHtml += `<span>${getName(ball2)}</span>`;
        }
        formulaHtml += '<span class="equals">=</span>';
        formulaHtml += `<img src="${getImg(item.img)}" alt="${item.name}">`;
        formulaHtml += `<span>${getName(item)}</span>`;
      }
      else if (item.components) {
        item.components.forEach((comp, i) => {
          const compEvo = getEvolution(comp);
          if (compEvo) {
            formulaHtml += `<img src="${getImg(compEvo.img)}" alt="${comp}">`;
            formulaHtml += `<span>${currentLang === 'cn' ? compEvo.nameCn : comp}</span>`;
          }
          else {
            formulaHtml += `<span>${comp}</span>`;
          }
          if (i < item.components.length - 1) {
            formulaHtml += '<span class="plus">+</span>';
          }
        });
        formulaHtml += '<span class="equals">=</span>';
        formulaHtml += `<img src="${getImg(item.img)}" alt="${item.name}">`;
        formulaHtml += `<span>${getName(item)}</span>`;
      }
      const formulaEl = document.getElementById('tooltipFormula');
      formulaEl.innerHTML = formulaHtml;
      formulaEl.style.display = formulaHtml ? 'flex' : 'none';

      // ËÆ°ÁÆó‰ΩçÁΩÆ
      const rect = event.target.closest('th, .matrix-cell, .gallery-item, .advanced-card').getBoundingClientRect();
      const tooltipWidth = 320;
      const tooltipHeight = 200;
      
      let left = rect.right + 10;
      let top = rect.top;

      // Âè≥‰æßÁ©∫Èó¥‰∏çË∂≥Êó∂ÊòæÁ§∫Âú®Â∑¶‰æß
      if (left + tooltipWidth > window.innerWidth) {
        left = rect.left - tooltipWidth - 10;
      }
      // Â∑¶‰æß‰πü‰∏çË∂≥Êó∂ÊòæÁ§∫Âú®‰∏ãÊñπ
      if (left < 0) {
        left = rect.left;
        top = rect.bottom + 10;
      }
      // Â∫ïÈÉ®Á©∫Èó¥‰∏çË∂≥Êó∂Âêë‰∏äË∞ÉÊï¥
      if (top + tooltipHeight > window.innerHeight) {
        top = window.innerHeight - tooltipHeight - 10;
      }
      // È°∂ÈÉ®Á©∫Èó¥‰∏çË∂≥Êó∂Âêë‰∏ãË∞ÉÊï¥
      if (top < 10) {
        top = 10;
      }

      tooltip.style.left = left + 'px';
      tooltip.style.top = top + 'px';
      tooltip.classList.add('visible');
    }

    function hideTooltip() {
      document.getElementById('tooltip').classList.remove('visible');
    }

    // ========== ÂºπÁ™ó ==========
    function openModal(evoName) {
      const evo = getEvolution(evoName);
      if (!evo) return;

      document.getElementById('modalImg').src = getImg(evo.img);
      document.getElementById('modalTitle').textContent = evo.name;
      document.getElementById('modalTitleCn').textContent = evo.nameCn || '';
      document.getElementById('modalEffect').textContent = getEffect(evo);

      // ÊûÑÂª∫ÈÖçÊñπ
      let formulaHtml = '';
      
      if (evo.row && evo.col) {
        // Âü∫Á°ÄËøõÂåñ
        const ball1 = getBaseBall(evo.row);
        const ball2 = getBaseBall(evo.col);
        
        if (ball1) {
          formulaHtml += `<div class="combo-ball">
            <img src="${getImg(ball1.img)}" alt="${ball1.name}" onerror="this.src='${getImg('placeholder.png')}'">
            <span>${getName(ball1)}</span>
          </div>`;
        }
        
        formulaHtml += '<span class="combo-plus">+</span>';
        
        if (ball2) {
          formulaHtml += `<div class="combo-ball">
            <img src="${getImg(ball2.img)}" alt="${ball2.name}" onerror="this.src='${getImg('placeholder.png')}'">
            <span>${getName(ball2)}</span>
          </div>`;
        }
      } else if (evo.components) {
        // È´òÁ∫ß/Ë¢´Âä®ËøõÂåñ
        evo.components.forEach((comp, i) => {
          const compEvo = getEvolution(comp);
          if (compEvo) {
            formulaHtml += `<div class="combo-ball" onclick="openModal('${comp}')">
              <img src="${getImg(compEvo.img)}" alt="${comp}" onerror="this.src='${getImg('placeholder.png')}'">
              <span>${currentLang === 'cn' ? compEvo.nameCn : comp}</span>
            </div>`;
          } else {
            formulaHtml += `<div class="combo-ball">
              <img src="${getImg('placeholder.png')}" alt="${comp}">
              <span>${comp}</span>
            </div>`;
          }
          
          if (i < evo.components.length - 1) {
            formulaHtml += '<span class="combo-plus">+</span>';
          }
        });
      }

      formulaHtml += '<span class="combo-equals">=</span>';
      formulaHtml += `<div class="combo-ball">
        <img src="${getImg(evo.img)}" alt="${evo.name}" onerror="this.src='${getImg('placeholder.png')}'">
        <span>${getName(evo)}</span>
      </div>`;

      document.getElementById('modalFormula').innerHTML = formulaHtml;
      document.getElementById('modalOverlay').classList.add('active');
    }

    function closeModal() {
      document.getElementById('modalOverlay').classList.remove('active');
    }

    // ========== ÊêúÁ¥¢ ==========
    function handleSearch(query) {
      query = query.toLowerCase().trim();
      
      document.querySelectorAll('.matrix-cell:not(.empty)').forEach(cell => {
        const evoName = cell.dataset.evo?.toLowerCase() || '';
        const evo = getEvolution(cell.dataset.evo);
        const nameCn = evo?.nameCn?.toLowerCase() || '';
        
        if (query && !evoName.includes(query) && !nameCn.includes(query)) {
          cell.style.opacity = '0.2';
        } else {
          cell.style.opacity = '1';
        }
      });

      document.querySelectorAll('.list-card').forEach(card => {
        const text = card.textContent.toLowerCase();
        card.style.display = query && !text.includes(query) ? 'none' : 'block';
      });

      document.querySelectorAll('.gallery-item').forEach(item => {
        const text = item.textContent.toLowerCase();
        item.style.display = query && !text.includes(query) ? 'none' : 'block';
      });

      document.querySelectorAll('.advanced-card').forEach(card => {
        const text = card.textContent.toLowerCase();
        card.style.display = query && !text.includes(query) ? 'none' : 'flex';
      });
    }

    // ========== ËßÜÂõæÂàáÊç¢ ==========
    function switchView(view) {
      currentView = view;
      
      document.querySelectorAll('.view-tab').forEach(tab => {
        tab.classList.toggle('active', tab.dataset.view === view);
      });

      document.querySelectorAll('.view-container').forEach(container => {
        container.classList.toggle('active', container.id === view + 'View');
      });

      // Ê†πÊçÆËßÜÂõæÊòæÁ§∫/ÈöêËóèÈ´òÁ∫ßÂå∫Âüü
      const showAdvanced = view !== 'gallery';
      document.getElementById('advancedSection').style.display = showAdvanced ? 'block' : 'none';
      document.getElementById('passiveSection').style.display = showAdvanced ? 'block' : 'none';
    }

    // ========== Ê∏≤ÊüìÂÖ®ÈÉ® ==========
    function renderAll() {
      renderMatrix();
      renderList();
      renderGallery();
      renderAdvancedSections();
    }

    // ========== ‰∫ã‰ª∂ÁªëÂÆö ==========
    document.addEventListener('DOMContentLoaded', () => {
      renderAll();

      // ËßÜÂõæÂàáÊç¢
      document.querySelectorAll('.view-tab').forEach(tab => {
        tab.addEventListener('click', () => switchView(tab.dataset.view));
      });

      // ÊêúÁ¥¢
      document.getElementById('searchInput').addEventListener('input', (e) => {
        handleSearch(e.target.value);
      });

      // ÂºπÁ™óÂÖ≥Èó≠
      document.getElementById('modalClose').addEventListener('click', closeModal);
      document.getElementById('modalOverlay').addEventListener('click', (e) => {
        if (e.target === e.currentTarget) closeModal();
      });

      // ESC ÂÖ≥Èó≠ÂºπÁ™ó
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') closeModal();
      });
    });
  </script>

</body>
</html>

